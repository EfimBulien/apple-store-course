@model TechStoreEll.Web.Models.ProductVariantCreateModel
@{
    // Index может быть числом или строкой "__index__" (шаблон)
    var indexObj = ViewData["Index"] ?? 0;
    var indexStr = indexObj.ToString();
}

<div class="variant-block border rounded-4 p-4 mb-4 bg-light">
    <div class="row g-3">
        <div class="col-12 d-flex justify-content-between align-items-center">
            <h5 class="fw-bold text-muted mb-0">
                <i class="bi bi-box me-2"></i>Вариант @(indexStr == "__index__" ? "#" : (int.TryParse(indexStr, out var idx) ? (idx + 1).ToString() : indexStr))
            </h5>
            <button type="button" class="btn btn-outline-danger btn-sm remove-variant">
                <i class="bi bi-trash me-1"></i>Удалить
            </button>
        </div>

        @* Используем data-field-name чтобы JS мог выставить корректные name/id/for *@
        <div class="col-md-4">
            <label class="form-label fw-semibold" data-label-for="VariantCode">
                <i class="bi bi-code text-muted me-1"></i>Код варианта *
            </label>
            <input data-field-name="VariantCode" value="@Model.VariantCode" class="form-control rounded-3" placeholder="Например: IPH16-WHT-256" />
        </div>

        <div class="col-md-3">
            <label class="form-label fw-semibold" data-label-for="Price">
                <i class="bi bi-currency-ruble text-muted me-1"></i>Цена *
            </label>
            <input data-field-name="Price" type="number" step="0.01" value="@(Model.Price == 0 ? "" : Model.Price.ToString())" class="form-control rounded-3" placeholder="0.00" />
        </div>

        <div class="col-md-3">
            <label class="form-label fw-semibold" data-label-for="Color">
                <i class="bi bi-palette text-muted me-1"></i>Цвет
            </label>
            <input data-field-name="Color" value="@Model.Color" class="form-control rounded-3" placeholder="Например: Белый" />
        </div>

        <div class="col-md-2">
            <label class="form-label fw-semibold" data-label-for="StorageGb">
                <i class="bi bi-hdd text-muted me-1"></i>Память (ГБ)
            </label>
            <input data-field-name="StorageGb" type="number" value="@(Model.StorageGb?.ToString() ?? "")" class="form-control rounded-3" placeholder="256" />
        </div>

        <div class="col-md-3">
            <label class="form-label fw-semibold" data-label-for="Ram">
                <i class="bi bi-memory text-muted me-1"></i>ОЗУ (ГБ)
            </label>
            <input data-field-name="Ram" type="number" value="@(Model.Ram?.ToString() ?? "")" class="form-control rounded-3" placeholder="8" />
        </div>

        <div class="col-12">
            <label class="form-label fw-semibold" data-label-for="Images">
                <i class="bi bi-images text-muted me-1"></i>Изображения варианта
            </label>
            <div class="image-upload">
                <input data-field-name="Images" type="file" class="form-control rounded-3" multiple accept="image/jpeg,image/png,image/gif,image/webp" />
                <div class="form-text">Можно выбрать несколько изображений. Первое будет основным.</div>
                <div class="image-preview mt-2 d-flex flex-wrap"></div>
            </div>
        </div>
    </div>
</div>
